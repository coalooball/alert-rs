#!/bin/bash

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘  ğŸš€ æ„å»ºå¹¶å¯åŠ¨ Axum æœåŠ¡å™¨                  â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# æ£€æŸ¥å‰ç«¯ä¾èµ–
if [ ! -d "frontend/node_modules" ]; then
    echo "ğŸ“¦ é¦–æ¬¡è¿è¡Œï¼Œæ­£åœ¨å®‰è£…å‰ç«¯ä¾èµ–..."
    cd frontend
    npm install
    cd ..
    echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"
    echo ""
fi

# æ„å»ºå‰ç«¯
echo "ğŸ¨ æ­£åœ¨æ„å»ºå‰ç«¯..."
cd frontend
npm run build
cd ..

if [ ! -d "frontend/dist" ]; then
    echo "âŒ å‰ç«¯æ„å»ºå¤±è´¥ï¼"
    exit 1
fi

echo "âœ… å‰ç«¯æ„å»ºå®Œæˆ"
echo ""

# å¯åŠ¨æœåŠ¡å™¨
echo "ğŸ¦€ æ­£åœ¨å¯åŠ¨ Axum æœåŠ¡å™¨..."
echo ""
cargo run --bin server --release

